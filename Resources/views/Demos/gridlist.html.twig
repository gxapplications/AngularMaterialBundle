{% extends "GXAngularMaterialBundle::base.html.twig" %}

{% block title %}GXAngularMaterialBundle:Demos:gridlist{% endblock %}

{% block stylesheets %}
	<style type="text/css">
		.grid {
			position: relative;
			height: 100%;
			list-style: none;
			/* Will be modified by the grid jquery lib, depending on the items */
			-webkit-transition: width 0.2s,
			height 0.2s;
			transition: width 0.2s,
			height 0.2s;
		}
		.grid li {
			position: absolute;
			z-index: 1;
			font-weight: bold;
			line-height: 1em;
			text-align: center;
			cursor: pointer;
			-webkit-transition: top 0.2s,
			left 0.2s,
			width 0.2s,
			height 0.2s,
			font-size 0.2s,
			line-height 0.2s;
			transition: top 0.2s,
			left 0.2s,
			width 0.2s,
			height 0.2s,
			font-size 0.2s,
			line-height 0.2s;
		}
		.grid li .inner {
			position: absolute;
			xxxxbackground: #555;
			top: 0;
			bottom: 10px;
			left: 10px;
			right: 0;
			-webkit-transition: background 3s;
			transition: background 3s;
		}
		.grid li.changed .inner {
			background: #ffff66;
			-webkit-transition: none;
			transition: none;
		}
		.grid li.ui-draggable-dragging {
			-webkit-transition: none;
			transition: none;
		}
		.grid li.position-highlight {
			-webkit-transition: none;
			transition: none;
		}
		.grid li.position-highlight .inner {
			background: #333;
		}

		div.gridlist-card button.md-mini img.s14 {
			width: 1.4rem;
			height: 1.4rem;
		}

	</style>
{% endblock %}

{% block body %}
<div layout="column" layout-fill style="overflow:hidden;" ng-controller="MainCtrl">

	<md-toolbar md-scroll-shrink>
		<div class="md-toolbar-tools">
			<md-button class="md-icon-button" aria-label="Settings">
				Menu
			</md-button>
			<h2>
				<span>Toolbar with Icon Buttons</span>
			</h2>
			<span flex></span>
			<md-button class="md-icon-button" aria-label="Favorite">
				A
			</md-button>
			<md-button class="md-icon-button" aria-label="More">
				B
			</md-button>
		</div>
	</md-toolbar>

	<md-content flex>
		<div flex>
			<ul id="grid" class="grid">
				<li class="position-highlight">
					<div class="inner md-whiteframe-1dp"></div>
				</li>
				<li class="position-card">
					<md-card class="md-whiteframe-6dp inner">
						<div flex layout="row" layout-align="center center">
							<md-progress-circular md-diameter="128"></md-progress-circular>
						</div>
					</md-card>
				</li>
			</ul>
		</div>
	</md-content>

	<md-fab-toolbar class="md-fab-bottom-right" style="width:100%" md-direction="left">
		<md-fab-trigger class="align-with-text">
			<md-button aria-label="menu" class="md-fab md-warn">
				Menu
			</md-button>
		</md-fab-trigger>
		<md-toolbar>
			<md-fab-actions class="md-toolbar-tools">
				<md-switch class="md-hue-1" aria-label="Switch to edit mode" ng-model="ctrl.editMode">
					Edit mode
				</md-switch>
				<md-button aria-label="comment" class="remove-row">
					Remove row
				</md-button>
				<md-button aria-label="comment" class="add-row">
					Add row
				</md-button>
			</md-fab-actions>
		</md-toolbar>
	</md-fab-toolbar>
</div>

{% endblock %}

{% block javascripts %}
	<script>
		var app = angular.module('MyApp', ['ngMaterial']);
		app.config(function($mdThemingProvider, $controllerProvider) {
			$mdThemingProvider.theme('default')
					.dark();
			app.controllerProvider = $controllerProvider;
		});

		app.controller("MainCtrl", function($scope) {
			this.editMode = false;
		});

		var fixtures = {
			DEMO: [
				{id: 1, w: 1, h: 1, x: 0, y: 0},
				{id: 2, w: 1, h: 2, x: 0, y: 1},
				{id: 3, w: 2, h: 2, x: 1, y: 0},
				{id: 4, w: 1, h: 1, x: 1, y: 2},
				{id: 5, w: 2, h: 1, x: 2, y: 2}
			]
		};

		$(function() {
			var gridStack = $('#grid').gridStack({
				matrix: fixtures.DEMO,
				onChange: function(changedItems, matrix) {
					// TODO: tests
					console.log(changedItems);
					console.log(matrix);
				},
				lanes: 6,
				elementPrototype: 'li.position-card',
				elementLoaderUrl: 'gridlist_card'
			});

			$('#grid li .resize').click(function(e) {
				e.preventDefault();
				var itemElement = $(e.currentTarget).closest('li'),
						itemWidth = $(e.currentTarget).data('w'),
						itemHeight = $(e.currentTarget).data('h');
				gridStack.resizeItem(itemElement, itemWidth, itemHeight);
			});
			$('.add-row').click(function(e) {
				e.preventDefault();
				gridStack.setLanes(gridStack.getLanes() + 1);
			});
			$('.remove-row').click(function(e) {
				e.preventDefault();
				gridStack.setLanes(gridStack.getLanes() - 1);
			});
		});
	</script>
{% endblock %}
